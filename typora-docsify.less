// write by vscode, format by prettier

// import code block css
@import "typora-docsify/codeblock.css";

// import google fonts
// @import url('https://fonts.googleapis.com/css2?family=Barlow:wght@400;600&family=JetBrains+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Poppins:ital,wght@0,400;0,600;1,400;1,600&display=swap');
@import (css)
  url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Poppins:ital,wght@0,400;0,600;1,400;1,600&display=swap");

/* æ•°å­—éƒ¨åˆ†ä½¿ç”¨ Barlow
é€‚é…æ•°å­—èŒƒå›´ ------------------------------
1234567890.,-+\/@
[0-9]U+30-39, [%]U+25, [+,-./]U+2B-2F, [\]U+5C, [@]U+40 

å­—é‡500çš„Barlowè·Ÿ400çš„Poppinsæ¯”è¾ƒé…

å¦‚æœéœ€è¦Barlowæ‰€æœ‰å­—ç¬¦ ç”¨ğŸ‘‡ ç„¶åå– Latin ------------------------------
https://fonts.googleapis.com/css2?family=Barlow:wght@500;600;700

Barlow latin ğŸ‘‡

400 Barlow
https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E3_-gs51os.woff2

500 Barlow
https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E3_-gs51os.woff2

600 Barlow Semibold
https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E30-8s51os.woff2

700 Barlow Bold
https://fonts.gstatic.com/s/barlow/v12/7cHqv4kjgoGqM7E3t-4s51os.woff2

å¦‚æœåªéœ€è¦æŒ‡å®šçš„å°‘æ•°å­—ç¬¦ ç”¨ğŸ‘‡ ------------------------------
https://fonts.googleapis.com/css2?family=Barlow:wght@500;600;700&text=1234567890.,-+\/@

è½¬æ¢base64ç‰ˆæœ¬å†…åµŒå­—ä½“ ------------------------------
https://transfonter.org
*/
@font-face {
  font-family: "Number";
  src: local("Barlow Medium"),
    url(https://fonts.gstatic.com/l/font?kit=7cHqv4kjgoGqM7E3_-gc5Ug4vRMOWJ6MD8KJkq_lkyBzFuY&skey=4c8d0d0b13516148&v=v12)
      format("woff2");
  font-weight: 400;
  unicode-range: U+30-39, U+25, U+2B-2F, U+5C, U+40;
}

@font-face {
  font-family: "Number";
  src: local("Barlow Semibold"),
    url(https://fonts.gstatic.com/l/font?kit=7cHqv4kjgoGqM7E30-8c5Ug4vRMOWJ6MD8KJkq_lkyBzFuY&skey=a9a2225c15335812&v=v12)
      format("woff2");
  font-weight: 600;
  unicode-range: U+30-39, U+25, U+2B-2F, U+5C, U+40;
}

// @font-face {
//   font-family: "Number";
//   src: local("Barlow Bold"),
//     url(https://fonts.gstatic.com/l/font?kit=7cHqv4kjgoGqM7E3t-4c5Ug4vRMOWJ6MD8KJkq_lkyBzFuY&skey=f60e73b1bbf362f3&v=v12)
//       format("woff2");
//   font-weight: 700;
//   unicode-range: U+30-39, U+25, U+2B-2F, U+5C, U+40;
// }

/* ä¼˜å…ˆå¯ç”¨è¡¨æƒ…å›¾æ ‡ é¿å…è¢« Nerd Font ç­‰å¤§å­—ç¬¦é›†è¦†ç›–ï¼Œæ¯”å¦‚âš ï¸
ä½†emojiä¼šè¦†ç›–æ•°å­—ï¼Œæ‰€ä»¥è¦é™å®šä¸€ä¸‹emojiçš„é€‚ç”¨èŒƒå›´ï¼Œé¿å¼€å¸¸ç”¨æ‹‰ä¸æ–‡ã€‚
è‹¹æœ: "AppleColorEmoji", Win: "Segoe UI Emoji" */
@font-face {
  font-family: "Emoji";
  src: local("AppleColorEmoji"), local("Segoe UI Emoji");
  unicode-range: U+300-FFFF;
}

:root {
  /* 
ç‰¹æ®Šå­—ä½“ï¼šEmoji, Number, 
ä¼˜å…ˆè‹±æ–‡ï¼š"Poppins", 
ä¼˜å…ˆä¸­æ–‡ï¼š"Source Han Sans HC",
è‹¹æœä¸­æ–‡ï¼š"SF Pro HK", "SF Pro Text", "SF Pro Icons", "PingFang HK",
å®‰å“ä¸­æ–‡ï¼š"Noto Sans", "Noto Sans CJK SC",
Winä¸­æ–‡ï¼š"Microsoft YaHei", "å¾®è½¯é›…é»‘",
è‹¹æœè‹±æ–‡ï¼š-apple-system, BlinkMacSystemFont, "Helvetica Neue", "Segoe UI",
å®‰å“è‹±æ–‡ï¼šRoboto, */
  --sans: Emoji, Number, "Poppins", "Source Han Sans HC", "SF Pro HK",
    "SF Pro Text", "SF Pro Icons", "PingFang HK", "Noto Sans",
    "Noto Sans CJK SC", "Microsoft YaHei", "å¾®è½¯é›…é»‘", -apple-system,
    BlinkMacSystemFont, "Helvetica Neue", "Segoe UI", Roboto, sans-serif;
  --font-family: var(--sans);
  --monospace: Emoji, "JetBrainsMono Nerd Font", "JetBrains Mono", Menlo,
    Consolas, "Source Han Sans HC", "SF Pro HK", "SF Pro Text", "SF Pro Icons",
    "PingFang HK", "Noto Sans", "Noto Sans CJK SC", "Microsoft YaHei",
    "å¾®è½¯é›…é»‘", monospace;

  //for Docsify ------------------------------
  --theme-color: #24d;
  --color-dark: #333;
  --color-light: #8882;
  --color-border: #8884;
  --color-important: #f30;
  --color-highlight: #ff4;
  --color-abbr: #0903;

  --block-border-radius: 0.5em;
  --block-margin: 1em;

  --code-block-padding-v: 0.75em;
  --code-block-padding-h: 1em;
  --code-block-bg-color: #000c;
  --code-border: 0px solid transparent;

  --inline-block-padding: 0.3rem;
  --inline-block-margin: 0.1rem;
  --color-inline-block-bg: #8882;
  --inline-border-radius: 0.25em;

  --line-height: 1.75;
  --font-weight: 400;
  --font-weight-bold: 600;
  --text-color: #333;
  --color-link: #93f;
  --color-em: #f69;
  --color-underline: #f33;
  --color-mark-text: #f33;
  --color-mark-bg: #ff3;
  --color-inline-code: #06b;

  // ç»™ä¸åŒçº§çš„æ ‡é¢˜æŸ“è‰² ç±»ä¼¼obsidiançš„minimalä¸»é¢˜
  --h1-color: var(--theme-color);
  --h2-color: var(--theme-color);
  --h3-color: var(--theme-color);
  --h4-color: var(--theme-color);
  --h5-color: var(--theme-color);
  --h6-color: var(--theme-color);
  // å¦‚æœä¸æƒ³ç”¨å½©è‰²çš„æ ‡é¢˜ï¼Œå°±æ³¨é‡Šæ‰ä»¥ä¸‹å‡ è¡Œ
  --h1-color: #f33;
  --h2-color: #33f;
  --h3-color: #93f;
  --h4-color: #f39;
  --h5-color: #f63;
  --h6-color: #3c3;

  //for Typora ------------------------------
  --bg-color: #fff;
  // --md-char-color: #F69; //æ”¹å˜å…ƒå­—ç¬¦çš„é¢œè‰²ï¼Œä¾‹å¦‚ markdown ä¸­çš„â€œ*â€

  //æ”¹å˜å…ƒå†…å®¹çš„é¢œè‰²ï¼Œä¾‹å¦‚ markdown ä¸­çš„å›¾åƒæ–‡æœ¬å’Œé“¾æ¥åœ°å€
  --meta-content-color: var(--theme-color);

  //ä¸»æŒ‰é’®çš„é¢œè‰²
  --primary-color: var(--theme-color);
  //   --window-border: 1px solid red; //è¾¹æ ç­‰çš„è¾¹æ¡† å¾ˆå°‘å‡ºç°

  // side bar menu
  --active-file-bg-color: var(--color-light);
  // --active-file-text-color: #FFF;
  --active-file-border-color: var(--theme-color);
  --side-bar-bg-color: #eee;
  --item-hover-bg-color: rgba(127, 127, 127, 0.1);
  //é¼ æ ‡æ‚¬åœæ—¶æ§ä»¶é¡¹çš„èƒŒæ™¯ï¼Œå¦‚ä¾§è¾¹æ ä¸­çš„èœå•
  --item-hover-text-color: inherit;
}

html,
body,
#write {
  font: 400 1rem / var(--line-height) var(--font-family);
  word-break: normal;
  min-height: 100vh;

  /* å­—ä½“æ¸²æŸ“ */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* è¡Œå†…å…ƒç´ è·¨è¡Œå¤åˆ¶æ–­å¼€å¤„æ ·å¼ */
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
  /* iOS overflowæ»šåŠ¨æ—¶ä¿æŒæ©¡çš®ç­‹æ•ˆæœ */
  -webkit-overflow-scrolling: touch;
  /* iOS æ¨ªå±å­—å·å˜åŒ–å…³é—­ */
  text-size-adjust: none;
  -moz-text-size-adjust: none;
  -webkit-text-size-adjust: none;
  /* iOS ç‚¹å‡»åŒºåŸŸä¸å‡ºç°ç°è‰² */
  -webkit-tap-highlight-color: transparent;
}

// typora:  #write
// docsify: .markdown-section
#write,
.markdown-section {
  max-width: 40em; // limit width by character number
  padding-left: 2em;
  padding-right: 2em;

  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  // ==================== æ ‡é¢˜
  h1,
  h1 *,
  h2,
  h2 *,
  h3,
  h3 *,
  h4,
  h4 *,
  h5,
  h5 *,
  h6,
  h6 * {
    color: var(--theme-color);
    font-family: var(--sans);
    font-weight: normal;
    padding: 0 !important;
    margin: 1rem 0 0 !important;
    line-height: 1.25 !important;
    text-wrap: balance;

    // header numbering ------------------------------
    &::before {
      font: 400 0.8em var(--sans);
      color: inherit;
      margin-right: 0.5rem;
      border: none;
      position: relative;
      left: unset;
      top: unset;
      float: none;
      padding: 0;
      vertical-align: baseline;
      opacity: 1 !important;
    }

    // Typora: show header level while focus
    &.md-focus:after {
      opacity: 0.25;
      font-size: 0.8em;
    }
  }

  // ç§»åŠ¨ç«¯é¡¶éƒ¨ç•™å‡ºè·ç¦»
  // padding ä¿è¯é”šç‚¹è·³è½¬åˆ°è¯¥å¤„ ä¸Šæ–¹ä»æœ‰ç©ºé—´
  h1:first-child {
    padding-top: 5rem !important;
  }

  h1 * {
    font-size: 2rem;
    color: var(--h1-color);
  }

  h2 {
    border: none;
    border-top: 1px solid var(--theme-color);
    padding-top: 1.5rem !important;
    margin-top: 2rem !important;
    display: block;
  }

  h2,
  h2 * {
    font-size: 1.75rem;
    color: var(--h2-color);
  }

  h3,
  h3 * {
    font-size: 1.5rem;
    color: var(--h3-color);
  }

  h4,
  h4 * {
    font-size: 1.25rem;
    font-weight: 500;
    color: var(--h4-color);
  }

  h5,
  h5 * {
    font-size: 1.125rem;
    font-weight: 500;
    color: var(--h5-color);
  }

  h6,
  h6 * {
    font-size: 1rem;
    font-weight: 500;
    color: var(--h6-color);
  }

  // ==================== Auto Numbering for Headings
  // https://support.typora.io/Auto-Numbering/
  // initialize css counter
  // #write {
  //     counter-reset: h1
  // }

  h1 {
    counter-reset: h2;
  }

  h2 {
    counter-reset: h3;
  }

  h3 {
    counter-reset: h4;
  }

  h4 {
    counter-reset: h5;
  }

  h5 {
    counter-reset: h6;
  }

  // put counter result into headings
  // skip h1, because I usually use H1 as main title
  h2::before {
    counter-increment: h2;
    content: counter(h2) ".";
  }

  h3::before {
    counter-increment: h3;
    content: counter(h2) "." counter(h3);
  }

  h4::before {
    counter-increment: h4;
    content: counter(h2) "." counter(h3) "." counter(h4);
  }

  h5::before {
    counter-increment: h5;
    // content: counter(h2)"."counter(h3) "."counter(h4) "."counter(h5)
    content: none;
  }

  h6::before {
    counter-increment: h6;
    // content: counter(h2)"."counter(h3) "."counter(h4) "."counter(h5) "."counter(h6)
    content: none;
  }

  // Typora: show header level while selected
  h2.md-focus::after {
    content: " H2";
  }

  h3.md-focus::after {
    content: " H3";
  }

  h4.md-focus::after {
    content: " H4";
  }

  h5.md-focus::after {
    content: " H5";
  }

  h6.md-focus::after {
    content: " H6";
  }

  // ============================== æ®µè½ & å—å…ƒç´ 

  // Typora: pre.md-fences, pre[data-lang]
  p,
  blockquote,
  ul,
  ol,
  pre.md-fences,
  pre[data-lang],
  table:not(.md-grid-board) {
    margin: 1rem 0;
  }

  hr,
  .md-hr {
    margin: 2rem 0;
    height: 0;
    border: none;
    border-bottom: 1px solid #8884;

    // h2é¡¶éƒ¨ä¼šç”»ä¸€æ¡çº¿ æ‰€ä»¥hråçš„h2è¦è°ƒæ•´ä¸‹
    & + h2 {
      margin-top: -2rem !important;
    }
  }

  // ============================== è¡Œå†…å…ƒç´ 
  // è¡Œå†…æœ‰èƒŒæ™¯çš„å°å—å…ƒç´ 
  .inline-with-bg {
    padding: 0.1em var(--inline-block-padding);
    margin: 0.5em var(--inline-block-margin);
    border-radius: var(--inline-border-radius);
    background: var(--color-inline-block-bg);
  }

  del,
  q,
  mark {
    .inline-with-bg();
  }

  // ä¸‹åˆ’çº¿ä¸Šçš„å¼ºè°ƒå…ƒç´ ä¸¤ä¾§ä¼šæ‰“æ–­ä¸‹åˆ’çº¿
  // å¦‚æœç”¨ä¼ªç±»åŠ ç©ºæ ¼åŠ å®½åº¦æ§åˆ¶ï¼Œdocsify åœ¨å¯¹è±¡åé¢æœ¬æ¥å°±æœ‰ç©ºæ ¼çš„æƒ…å†µä¸‹ï¼Œafter åé¢çš„åŸæœ¬çš„é‚£ä¸ªç©ºæ ¼ä¼šè¢«â€œåƒâ€æ‰ã€‚typora å‰åæœ‰ span åŒ…è£¹ã€‚
  // å¦‚æœç”¨ä¼ªç±»åŠ éç©ºæ ¼å­—ç¬¦åŠ é€æ˜è‰²åŠ å®½åº¦æ§åˆ¶ï¼Œå¯ä»¥é¿å…åæ–¹ç©ºæ ¼è¢«åƒã€‚
  // ä½†ä»»ä½•ä¼ªç±»å­—ç¬¦éƒ½ä¼šå½±å“å¤åˆ¶ã€‚
  strong,
  b,
  em {
    margin: 0 var(--inline-block-margin);
  }

  // inline-block margin
  u {
    margin: 0 var(--inline-block-margin);

    // ä¸‹åˆ’çº¿ä¸Šçš„å¼ºè°ƒå…ƒç´ ä¸¤ä¾§ä¸åŠ é—´è·
    strong,
    b,
    em {
      margin: 0;
    }
  }

  // without hedaer a
  p,
  table,
  li {
    a {
      .inline-with-bg();
      color: var(--color-link);
      padding: 0;
      background: transparent;
      transition: 1s;
      // text-decoration-color: transparent;
    }
  }

  a:hover {
    color: var(--color-important);
    text-decoration-color: var(--color-underline); // specific for header
    background: var(--color-highlight);
    transition: 0.3s;
  }

  // Docsify: æ ‡é¢˜a
  h1 a,
  a.anchor {
    text-decoration: underline;
    text-decoration-color: transparent;

    &:hover {
      background: var(--color-highlight);
    }
  }

  strong,
  b {
    // font-size: bolder;
  }

  p strong,
  p b {
    // color: var(--color-important);
  }

  del {
    color: var(--text-color);
    opacity: 0.5;
  }

  u {
    // text-decoration: none;
    // border-bottom: 1px solid var(--color-important);
    text-decoration-color: var(--color-underline);
    // text-underline-position: under;
  }

  mark {
    color: var(--color-mark-text);
    background: var(--color-mark-bg);

    // font-weight: 500;
    strong {
      color: var(--color-important);
    }

    u {
      text-decoration: none;
      border-bottom: 1.5px solid var(--color-underline);
      // background: var(--color-highlight);
    }
  }

  // å•æ˜Ÿå· æ–œä½“
  em {
    color: var(--color-em);
    // font-weight: 600;
  }

  // è¡Œå†…å¼•ç”¨ ç”¨æ¥åšæ·¡åŒ–æ˜¾ç¤º
  q {
    font-size: 0.9em;
    opacity: 0.5;
    line-height: var(--line-height);
    transition: opacity 1s;

    &::before,
    &::after {
      content: "";
    }

    &:hover {
      opacity: 1;
      transition: opacity 0.3s;
    }
  }

  // å‡ºç°åœ¨è¡¨æ ¼å†…çš„è¡Œå†…æ ‡ç­¾
  .md-raw-html-src-content,
  .md-raw-inline,
  .md-tag,
  [md-inline="linebreak"] {
    opacity: 1;
    .inline-with-bg();
    background: var(--color-light);
    color: inherit;
    // font-weight: bold;
  }

  // éŸ³æ ‡
  ruby {
    text-decoration: underline;
    text-decoration-color: transparent;
    transition: text-decoration-color 0.3s;

    rt {
      font-size: clamp(10px, 0.5em, 100px) !important;
      transform-origin: bottom;
      transition: all 0.3s;
    }
    &:hover {
      text-decoration-color: inherit;
      rt {
        transform: scale(1.5);
      }
    }
  }

  // ============================== ä»£ç  å¼•ç”¨

  // docsify dark theme
  code,
  kbd,
  code:not([class*="lang-"]):not([class*="language-"]) {
    color: var(--color-inline-code);
    background: var(--color-light);
    border: var(--code-border);
    border-radius: var(--inline-border-radius);
    padding: 0.1em var(--inline-block-padding);
    margin: 0 var(--inline-block-margin);
    font: bold 0.9em var(--monospace);
    white-space: pre-wrap; // è¡Œå†…ä»£ç å°½é‡è§„é¿é•¿ä»£ç 
    min-width: unset;
  }

  .code_block {
    background: var(--code-block-bg-color);
    color: #fff;
    border: var(--code-border);
    border-radius: var(--block-border-radius);
    padding: var(--code-block-padding-v) var(--code-block-padding-h);
    word-break: break-word;
    white-space: break-spaces;
  }

  // Docsify
  pre[data-lang] {
    border-radius: 0;
    background: none;

    code {
      margin: 0;
      .code_block();
    }

    // Docsify: language mark (top right)
    &::after {
      color: #fff;
      top: 0;
      right: 1em;
      background: #fff2;
      padding: 0.2em 0.8em;
      border-radius: 0 0 0.5em 0.5em;
    }
  }

  // Typora
  pre.md-fences {
    .code_block();
    .CodeMirror,
    .CodeMirror-scroll {
      background: none;
    }
  }

  // codeåœ¨è¡Œé¦–ä¸ç•™margin-left
  // *[md-inline="code"]:first-child code {
  //     margin-left: 0;
  // }

  // typora editor code type, e.g. html/bash
  .code-tooltip {
    box-shadow: none;
    border-radius: var(--block-border-radius);
    border: var(--code-border);
  }

  kbd {
    box-shadow: none;
  }

  // è¿ç»­çš„æŒ‰é”®å—å¢åŠ é—´è·
  // [A]=([B]+[C]) Bå·¦ä¾§ä¹Ÿå¯èƒ½ä¼šè¢«åŠ ä¸Šè¾¹è· å¦‚æœæ‹¬å·æ²¡æœ‰è¢«å…ƒç´ åŒ…è£¹
  kbd + kbd {
    margin-left: var(--inline-block-margin);
  }

  blockquote {
    --block-gap: 0.75rem;
    padding: var(--block-gap) 0.75rem;
    border-left: 4px solid var(--color-border);
    background: var(--color-light);
    color: var(--text-color);
    border-radius: 0 var(--block-border-radius) var(--block-border-radius) 0;
    transition: 1s;

    p {
      font: 0.9em/1.5 var(--sans);
      margin: var(--block-gap) 0;

      &:first-child {
        margin-top: 0;
      }

      &:last-child {
        margin-bottom: 0;
      }
    }

    &:hover {
      transition: 0.2s;
      border-left: 4px solid var(--theme-color);
      background: var(--color-light);
      color: var(--text-color);
    }
  }

  // pre yaml
  pre.md-meta-block,
  hr:first-child + p {
    .code_block();
    background: var(--color-light);
    font: 0.75rem/1.5 var(--monospace);
    color: var(--text-color);
    opacity: 0.5;
    transition: opacity 1s;

    &:hover {
      opacity: 1;
      transition: opacity 0.3s;
    }
  }

  hr:first-child,
  hr:first-child + p + hr {
    display: none;
  }

  // ============================== å›¾ç‰‡
  .md-image,
  img {
    max-width: 100%;
    max-height: 80vh;
    display: block;
    margin: 0 auto;
    border: none;
    border-radius: var(--block-border-radius);
    box-shadow: 0 0 2px #0000;
    transition: all 0.3s !important;

    &:hover {
      box-shadow: 0 0 2px #0004;
    }
  }

  // å›¾ç‰‡å’Œå›¾ç‰‡é—´çš„è½¯æ¢è¡Œå¢åŠ é—´è·
  .md-image + .md-softbreak {
    height: 1em;
  }

  // ============================== åˆ—è¡¨
  ul,
  ol {
    margin: 0.5em 0;
    padding-left: 3ch;

    li {
      margin: 0.5em 0;
    }

    ul,
    ol {
      margin: 0.3em 0;

      li {
        margin: 0.3em 0;
      }
    }
  }

  // typora will add p in li
  li p {
    margin: 0;
  }

  ol li::marker {
    font: 0.9em var(--monospace);
  }

  // å¤„ç† checkbox
  .task-list-item {
    margin-left: 0 !important;
    position: relative;

    input[type="checkbox"] {
      width: 1.5em !important;
      margin: 0;
      position: absolute;
      left: -1.5em;
      top: 0.5em;
    }
  }

  // ============================== è¡¨æ ¼
  .table_light {
    border: 1px solid var(--color-border);

    th,
    td {
      border-bottom: 1px solid var(--color-border);
    }

    th {
      background: var(--color-light);
    }

    tbody tr:nth-child(even) {
      background: #8881;
    }
  }

  .table_dark {
    background: var(--color-dark);

    th,
    td {
      color: white;
    }

    th {
      background: var(--color-dark);
      color: var(--color-em);
    }

    tbody tr:nth-child(even) {
      background: var(--color-dark);
    }
  }

  table:not(.md-grid-board),
  .md-table {
    display: table;
    width: auto;
    border-radius: var(--block-border-radius);
    overflow: hidden;
    font: 0.9rem/1.25 var(--monospace);
    border-collapse: separate;

    // border: 1px solid var(--color-dark);
    th,
    td {
      padding: 0.5em clamp(0.5em, 1vw, 2em);
      vertical-align: top;
      border: none;

      &:not(:last-child) {
        border-right: 1px dashed #8888;
      }
    }

    tr:last-child td {
      border-bottom: none;
    }

    .table_light();
    // .table_dark();
  }

  // ============================== def
  .md-def-name {
    color: #888;

    &::before,
    &::after {
      font-size: 0.9rem;
      color: #888;
      position: relative;
    }
  }

  // ============================== abbr
  // <abbr title="å±•å¼€è§£é‡Š">ç¼©å†™çš„å†…å®¹</abbr>
  abbr {
    text-decoration: underline;
    text-decoration-color: var(--theme-color);
    // text-decoration-style: dashed;
    // background: @c_abbr;
  }

  // ============================== mermaid
  // typora normal: .md-fences[lang="mermaid"]:not(.md-focus)
  // typora editing: .md-diagram-panel;
  // docsify: .mermaid;
  .md-fences[lang="mermaid"]:not(.md-focus),
  .md-diagram-panel,
  .mermaid {
    background: #fff;

    * {
      font-family: var(--sans) !important;
    }
  }

  // typora - move diagram inside the code block
  pre.md-fences-advanced.md-focus {
    &[lang="mermaid"] {
      margin-bottom: 1em !important;
    }

    .md-fences-adv-panel {
      position: relative;
      background: #fff;
      border-radius: 0 0 var(--block-border-radius) var(--block-border-radius);
      margin: var(-code-block-padding-v) calc(var(--code-block-padding-h) * -1)
        calc(var(-code-block-padding-v) * -1);
      width: calc(~"100% + " var(--code-block-padding-h) * 2);
      border: 1px solid var(--color-dark);
    }
  }

  // docsify
  .mermaid {
    display: flex;
    justify-content: center;

    .messageText {
      stroke: none !important;
    }
  }
}

// ==================== typora br patch
.md-linebreak {
  font-size: 0;

  .md-linebreak-mark {
    font-size: 0.8rem;
    opacity: 0.25 !important;
  }
}

table {
  .md-br,
  .md-br-content {
    font-size: 0;
    padding: 0 !important;
    margin: 0 !important;
  }
}

// ==================== typora focus mode patch
// fix the header numbering
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) {
  &::before,
  &::after {
    color: #c8c8c8 !important;
    color: var(--blur-text-color) !important;
  }
}

// ==================== typora edit mode
#typora-source {
  font-family: var(--monospace) !important;

  .CodeMirror-code > div {
    // display: flex;
    // flex-flow: row nowrap;
    // align-items: center;
  }

  .CodeMirror-gutter-wrapper,
  .CodeMirror-linenumber {
    // position: relative !important;
  }

  // line number
  .CodeMirror-linenumber {
    visibility: visible;
    font-family: var(--monospace);
  }
}

// ==================== typora sidebar
#outline-content {
  padding: 0 0.5em;
  font: 400 0.8em var(--monospace);
  --header-indent: 2ch;
  --item-padding-h: 0.5em;

  // æ§åˆ¶æ ‡é¢˜å±‚çº§å’Œæ ‡é¢˜çš„å…³ç³»
  li {
    ul {
      padding-left: var(--header-indent); // æ§åˆ¶æ ‡é¢˜ç¼©è¿›
      // border: 1px solid red;
    }

    .outline-item {
      // æ ‡é¢˜é¡¹
      padding: 0.5em var(--item-padding-h) !important;
      margin: 0;
      border: none;
      border-radius: 0.25em;

      // å±•å¼€ç®­å¤´
      .outline-expander {
        padding-right: 1ch;
      }

      .outline-label {
        font: 1.25em var(--sans);

        &:hover {
          text-decoration: none; //æ³¨é”€åŸæœ¬çš„æ ·å¼ ä¼šæœ‰ä¸‹åˆ’çº¿ç²—ç»†ä¸åŒ€çš„é—®é¢˜
        }
      }

      &::before {
        display: inline-block;
        flex: none;
        // min-width: calc(1em - .25em);
        // text-align: right;
        padding: 0.3em 0.25em;
        // margin-right: .25em;
        position: absolute;
        text-align: right;
        opacity: 0;
        transition: all 3s;

        &:hover {
          color: #fff;
          background: red;
          border-radius: 0.25em;
          z-index: 99;
        }
      }

      // æ‚¬æµ®æ˜¾ç¤ºæ ‡é¢˜
      &:hover,
      .outline-active {
        &::before {
          opacity: 0.75;
          transition: all 0s;
        }
      }

      &:hover {
        background-color: inherit;
      }

      // å½“å‰æ»šåŠ¨ä½ç½® - æ¿€æ´»çŠ¶æ€
      .outline-active {
        color: var(--theme-color);
        font-weight: bold !important;
      }
    }
  }

  // numbering
  .outline-h1 {
    counter-reset: h2;
    overflow: hidden;

    & > ul {
      padding-left: calc(var(--header-indent) + var(--item-padding-h));
    }
  }

  .outline-h2 {
    padding: 2px 0;
    counter-reset: h3;
    counter-increment: h2;

    // top divide line
    &::before {
      content: "";
      display: block;
      height: 0px;
      width: 200%;
      position: absolute;
      top: 0;
      left: -50%;
      border-top: 0.5px solid #0001;
    }

    & > .outline-item::before {
      content: counter(h2);
      min-width: calc(var(--header-indent) * 1);
      left: calc(var(--header-indent) * -1);
      opacity: 0.75;
    }
  }

  .outline-h3 {
    counter-reset: h4;
    counter-increment: h3;

    & > .outline-item::before {
      content: counter(h2) "." counter(h3);
      min-width: calc(var(--header-indent) * 2);
      left: calc(var(--header-indent) * -2);
    }
  }

  .outline-h4 {
    counter-reset: h5;
    counter-increment: h4;

    & > .outline-item::before {
      content: counter(h2) "." counter(h3) "." counter(h4);
      min-width: calc(var(--header-indent) * 3);
      left: calc(var(--header-indent) * -3);
    }
  }

  .outline-h5 {
    counter-reset: h6;
    counter-increment: h5;

    & > .outline-item::before {
      content: counter(h2) "." counter(h3) "." counter(h4) "." counter(h5);
      min-width: calc(var(--header-indent) * 4);
      left: calc(var(--header-indent) * -4);
    }
  }

  .outline-h6 {
    counter-increment: h6;

    & > .outline-item::before {
      content: counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) "."
        counter(h6);
      min-width: calc(var(--header-indent) * 5);
      left: calc(var(--header-indent) * -5);
    }
  }
}

// ä¾§è¾¹æ ä¸ç”¨hoverå°±æ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹
.sidebar-footer {
  border-top-color: var(--color-light);
}

.pin-outline #typora-sidebar .sidebar-footer:not(.show-sidebar-footer-context) {
  opacity: 1;
  display: block;
}

#typora-sidebar.use-file-tree-style
  .sidebar-footer-item:not(#sidebar-new-file-btn) {
  opacity: 1;
}

// ============================== docsify sidebar
// é¡¶éƒ¨åŒºåŸŸ
.sidebar > h1 .app-name-link {
  display: flex;
  justify-content: center;
  align-items: center;

  img {
    max-height: 3em;
  }
}

// æ–‡ç« æ ‡é¢˜
.sidebar-nav {
  margin: 0;

  > a {
    line-height: 1.25em;

    strong {
      font-weight: normal;
    }
  }

  &.active {
    position: relative;

    &:before {
      content: "";
      position: absolute;
      width: 200%;
      height: 100%;
      left: -50%;
      background: rgba(255, 255, 255, 1);
      z-index: -1;
    }

    > a {
      border-color: var(--theme-color);
      color: var(--theme-color);

      strong {
        font-weight: bold;
        color: var(--theme-color);
      }
    }
  }
}

// ============================== docsify mobile
// main area
.markdown-section {
  padding: env(safe-area-inset-top)
    calc(2em + env(safe-area-inset-left) + env(safe-area-inset-right) + 1vw)
    env(safe-area-inset-bottom);
}

// sidebar toggle handle
.sidebar-toggle .sidebar-toggle-button {
  zoom: 0.8;
  opacity: 0.5;
}
